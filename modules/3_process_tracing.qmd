---
title: "Process Tracing with a Causal Model"
subtitle: "Causal Inference from Causal Models"
format: 
   revealjs:
      embed-resources: true
      theme: serif
      slide-level: 3
      slide-number: true
      toc-depth: 2
      show-slide-number: all
      preview-links: auto
      number-sections: true
      link-color: orange
      smaller: true
---

```{r, include = FALSE}
set.seed(1)
library(knitr)
source("assets/setup.R")
knitr::opts_chunk$set(echo = TRUE)
```


## Process tracing with a DAG

```{r, echo = FALSE}
make_model("I -> M -> D") |> plot(x_coord = 1:3, y_coord = 3:1)
```

* Simple insight: *If* you believe this model, then seeing $M$ should tell you something about a query regarding the $I$, $D$ relationship in a case.

* For instance, we might have the intuition: *If there was no mobilization in a high-inequality case that democratized, then inequality didn't cause the transition.*

*But how do we formalize this strategy?*


## Process tracing with a Causal Model


```{r, echo = FALSE}
make_model("I -> M -> D") |> plot(x_coord = 1:3, y_coord = 3:1)
```

* Great as this is, the DAG---by itself---tells us nothing about the *direction* of effects
  * Inequality might boost or depress mobilization
  * Mobilization might encourage or delay democratization
* For process-tracing, you need an *informative* **causal model**

## Process tracing as new data for finer inferences

* We are focusing on a case

* We start with:

  1. A background *theory* about how things work in cases like this
  2. Background knowledge about the case: perhaps the outcome; perhaps the value of a causal condition or two
    
* What we don't know is whether any of those conditions *caused* the outcome

* So:

  1. we collect *more* information "from other parts of the DAG"  to help figure that out
  2. we have a *plan* for what to infer about effects depending on what we find

## Process tracing with a DAG

Key formal insight:

```{r, echo = FALSE, fig.width = 5, fig.height = 3,  fig.align = "center", out.width='.9\\textwidth'}

make_model("X-> M -> D <- Q2; Q1 -> M") |> 
  plot_model(
      labels = c('I', "theta^D", "theta^M", 'M', 'D'),
      parse = TRUE,
      textcol  = "black", nodecol = "white",)

```

*If* you believe this model, then seeing $M$ should tell you something about the $\theta$s---which are what define the effect of $I$ on $D$. 

## From the DAG alone...

We can tell when some evidence might *potentially* matter

```{r, echo = FALSE, fig.align = "center", eval = TRUE}
knitr::include_graphics("assets/possibly_informative.jpg")
```



## Principle: Clues can lie in many places

Three clues for figuring out the effect of $X$ on $Y$

```{r, echo = FALSE}
model <- make_model("X -> K1 -> Y <- K2; Y -> K3; Y <-> K3") 

model |> plot(x_coord = c(2,1,2,3,4), y_coord = c(2, 1, 1, 1, 0))

```

# Example: Democratization in Malawi (1994)

*Alan*

Let's walk though the intuition with a case

## A case-level question: Malawi (1994)

```{r, echo = FALSE, fig.width = 5, fig.height = 3,  fig.align = "center", out.width='.9\\textwidth'}
par(mar=c(1,1,1,1))
hj_dag(x = c(0, 2, 1),
       y = c(1, 1, 1),
       names = c("I", "D", "M"), 
       arcs = cbind( c(1, 3),
                     c(3, 2)),
       padding = .4, contraction = .15)

```

* Suppose we observe democratization as the outcome in Malawi: $D=1$

* We also observe high inequality in Malawi: $I=1$

* We want to know: did $I=1$ cause $D=1$ in Malawi?


## Prior data on Malawi

```{r, echo = FALSE, fig.width = 5, fig.height = 3,  fig.align = "center", out.width='.9\\textwidth'}
par(mar=c(1,1,1,1))
hj_dag(x = c(0, 2, 1),
       y = c(1, 1, 1),
       names = c("I", "D", "M"), 
       arcs = cbind( c(1, 3),
                     c(3, 2)),
       padding = .4, contraction = .15)

```

* Let's process-trace: observe $M$ in Malawi
    * Was there mass mobilization in Malawi?


## New *within-case* data on Malawi

```{r, echo = FALSE, fig.width = 5, fig.height = 3,  fig.align = "center", out.width='.9\\textwidth'}
par(mar=c(1,1,1,1))
hj_dag(x = c(0, 2, 1),
       y = c(1, 1, 1),
       names = c("I", "D", "M"), 
       arcs = cbind( c(1, 3),
                     c(3, 2)),
       padding = .4, contraction = .15)

```

* Suppose we go to the field and we learn that mass mobilization DID occur in Malawi
    * So $M=1$

* What can we conclude?

* NOTHING YET!


## Inference 


```{r, echo = FALSE, fig.width = 5, fig.height = 3,  fig.align = "center", out.width='.9\\textwidth'}
par(mar=c(1,1,1,1))
hj_dag(x = c(0, 2, 1),
       y = c(1, 1, 1),
       names = c("I", "D", "M"), 
       arcs = cbind( c(1, 3),
                     c(3, 2)),
       padding = .4, contraction = .15)

```

* We knew $I=1$, $D=1$

* We then saw $M=1$

* But which is more consistent with $I=1$ causing $D=1$?
    * Mobilization occurring? or
    * Mobilization not occurring?


## Why prior theory matters for process tracing

```{r, echo = FALSE, fig.width = 5, fig.height = 3,  fig.align = "center", out.width='.9\\textwidth'}
par(mar=c(1,1,1,1))
hj_dag(x = c(0, 2, 1),
       y = c(1, 1, 1),
       names = c("I", "D", "M"), 
       arcs = cbind( c(1, 3),
                     c(3, 2)),
       padding = .4, contraction = .15)

```

* Suppose I believe that high inequality usually **prevents** mass mobilization
    * Poverty makes it harder to mobilize
    
* Suppose I also believe that mobilization usually **prevents** democratization
    * Instills fear in autocrats and provokes repression
    
* Which value of $M$ would be most consistent with $I=1$ causing $D=1$?
    * $M=0$
 
## Why prior theory matters for process tracing

```{r, echo = FALSE, fig.width = 5, fig.height = 3,  fig.align = "center", out.width='.9\\textwidth'}
par(mar=c(1,1,1,1))
hj_dag(x = c(0, 2, 1),
       y = c(1, 1, 1),
       names = c("I", "D", "M"), 
       arcs = cbind( c(1, 3),
                     c(3, 2)),
       padding = .4, contraction = .15)

```

* Suppose I believe that high inequality usually **causes** mass mobilization
    * Inequality creates grievances for protest
    
* Suppose I also believe that mobilization usually **causes** democratization
    * Instills fear in autocrats and provokes concessions
    
* Which value of $M$ would be most consistent with $I=1$ causing $D=1$?
    * $M=1$
    
    
## Why prior theory matters for process tracing

```{r, echo = FALSE, fig.width = 5, fig.height = 3,  fig.align = "center", out.width='.9\\textwidth'}
par(mar=c(1,1,1,1))
hj_dag(x = c(0, 2, 1),
       y = c(1, 1, 1),
       names = c("I", "D", "M"), 
       arcs = cbind( c(1, 3),
                     c(3, 2)),
       padding = .4, contraction = .15)

```

* If I believe inequality usually causes democratization by preventing mobilization, which itself hinders democratization...
    * then observing $M=0$ constitutes evidence that $I=1$ caused $D=1$

* If I believe inequality usually causes democratization by causing mobilization, which itself causes democratization...
    * then observing $M=1$ constitutes evidence that $I=1$ caused $D=1$




## Key point: Process tracing is always theory dependent

* The evidence in process tracing never speaks for itself

* Our inferences from PT evidence always depend on theory
    * On our beliefs about how the world works
    
* Most process tracing is either silent about these beliefs or expresses them informally

* We can formalize these beliefs
    * Maximize explicitness and analytic transparency

<!-- ## In practice: Process tracing in Malawi -->

<!-- * Prior beliefs we use in the book (roughly): -->
<!--     * $I$ has positive effect on $M$ 50% of the time (given other data)     -->
<!--     * $I$ never has a negative effect on $M$ -->
<!--     * $M$ has positive effect on $D$ 50% of the time -->
<!--     * $M$ never has a negative effect on $D$ -->

<!-- * We process trace and observe that mobilization occurred: $M=1$ -->

<!-- * Given our priors, this observation **increases** our confidence that $I=1$ caused $D=1$ -->









